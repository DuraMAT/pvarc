import numpy as np
import pandas as pd
import os

dir_path = os.path.dirname(os.path.realpath(__file__))


def refractive_index_imaginary_silica(wavelength):
    dir_path = os.path.dirname(os.path.realpath(__file__))
    fname = os.path.join(dir_path, 'materials', 'refractive_index_k_silica_Kitamura2007.csv')
    df = pd.read_csv(fname)
    print(df.keys())
    k = np.interp(wavelength, df['wavelength'] * 1000., df['k'])

    return k

def reflectance_PTFE(wavelength):


    dir_path = os.path.dirname(os.path.realpath(__file__))
    fname = os.path.join(dir_path, 'materials', 'PMR10_PTFE_reflectance.xlsx')
    df = pd.read_excel(fname)
    reflectance =  np.interp(wavelength, df['Wavelength (nm)'], df['Reflectance (%)'])

    return reflectance


def refractive_index_fused_silica(wavelength):
    """
    Refractive index for Corning UV fused silica 7980

    https://www.corning.com/media/worldwide/csm/documents/5bf092438c5546dfa9b08e423348317b.pdf

    Parameters
    ----------
    wavelength
        wavelength in nm

    Returns
    -------

    """
    wavelength_um = wavelength / 1000

    A0 = 2.104025406E+00
    A1 = -1.456000330E-04
    A2 = -9.049135390E-03
    A3 = 8.801830992E-03
    A4 = 8.435237228E-05
    A5 = 1.681656789E-06
    A6 = -1.675425449E-08
    A7 = 8.326602461E-10

    n = np.sqrt( A0 + A1 * wavelength_um ** 4 + A2 * wavelength_um ** 2 + A3 * wavelength_um ** -2 + \
         A4 * wavelength_um ** -4 + A5 * wavelength_um ** -6 + A6 * wavelength_um ** -8 + A7 * wavelength_um ** -10 )

    return n


def refractive_index_amorphous_silicon(wavelength):
    """
    Refractive index for amorphous silicon.

    https://refractiveindex.info/tmp/database/data-nk/main/Si/Pierce.csv

    Parameters
    ----------
    wavelength
        wavelength in nm

    Returns
    -------
    n
        refractive index

    """
    wavelength_real_n = [[1.033E-1,3.27E-1],[1.078E-1,3.63E-1],[1.127E-1,3.92E-1],[1.181E-1,4.23E-1],[1.240E-1,4.59E-1],
                         [1.305E-1,4.97E-1],[1.378E-1,5.43E-1],[1.459E-1,5.97E-1],[1.550E-1,6.60E-1],[1.653E-1,7.35E-1],
                         [1.771E-1,8.32E-1],[1.907E-1,9.51E-1],[2.066E-1,1.11E+0],[2.254E-1,1.35E+0],[2.480E-1,1.69E+0],
                         [2.583E-1,1.86E+0],[2.695E-1,2.07E+0],[2.818E-1,2.30E+0],[2.952E-1,2.56E+0],[3.100E-1,2.87E+0],
                         [3.263E-1,3.21E+0],[3.444E-1,3.55E+0],[3.543E-1,3.73E+0],[3.647E-1,3.90E+0],[3.875E-1,4.17E+0],
                         [4.133E-1,4.38E+0],[4.428E-1,4.47E+0],[4.769E-1,4.49E+0],[4.960E-1,4.47E+0],[5.166E-1,4.46E+0],
                         [5.636E-1,4.36E+0],[6.199E-1,4.23E+0],[6.526E-1,4.17E+0],[6.888E-1,4.09E+0],[7.293E-1,4.01E+0],
                         [7.749E-1,3.93E+0],[8.266E-1,3.86E+0],[8.856E-1,3.77E+0],[9.538E-1,3.68E+0],[1.033E+0,3.61E+0],
                         [1.127E+0,3.57E+0],[1.240E+0,3.54E+0],[1.378E+0,3.50E+0],[1.550E+0,3.48E+0],[1.771E+0,3.45E+0],
                         [2.066E+0,3.44E+0]]
    wavelength_k = [[1.033E-1,7.26E-1],[1.078E-1,8.47E-1],[1.127E-1,9.46E-1],[1.181E-1,1.04E+0],[1.240E-1,1.14E+0],
                    [1.305E-1,1.24E+0],[1.378E-1,1.35E+0],[1.459E-1,1.47E+0],[1.550E-1,1.60E+0],[1.653E-1,1.74E+0],
                    [1.771E-1,1.89E+0],[1.907E-1,2.07E+0],[2.066E-1,2.28E+0],[2.254E-1,2.51E+0],[2.480E-1,2.76E+0],
                    [2.583E-1,2.85E+0],[2.695E-1,2.93E+0],[2.818E-1,2.99E+0],[2.952E-1,3.04E+0],[3.100E-1,3.06E+0],
                    [3.263E-1,3.00E+0],[3.444E-1,2.88E+0],[3.543E-1,2.79E+0],[3.647E-1,2.66E+0],[3.875E-1,2.38E+0],
                    [4.133E-1,2.02E+0],[4.428E-1,1.64E+0],[4.769E-1,1.28E+0],[4.960E-1,1.12E+0],[5.166E-1,9.69E-1],
                    [5.636E-1,6.90E-1],[6.199E-1,4.61E-1],[6.526E-1,3.63E-1],[6.888E-1,2.71E-1],[7.293E-1,1.99E-1],
                    [7.749E-1,1.36E-1],[8.266E-1,8.12E-2],[8.856E-1,4.01E-2],[9.538E-1,0.00E+0],[1.033E+0,0.00E+0],
                    [1.127E+0,0.00E+0],[1.240E+0,0.00E+0],[1.378E+0,0.00E+0],[1.550E+0,0.00E+0],[1.771E+0,0.00E+0],
                    [2.066E+0,0.00E+0]]

    real_n = np.interp(wavelength, 1e3 * np.array(wavelength_real_n)[:, 0], np.array(wavelength_real_n)[:, 1],
                       left=1.5539233467171, right=1.4473825472731)
    imag_n = np.interp(wavelength, 1e3 * np.array(wavelength_k)[:, 0], np.array(wavelength_k)[:, 1], left=1.191E-5,
                       right=1.054E-3)

    n = real_n + 1j * imag_n

    return n


def refractive_index_glass(wavelength, type='soda-lime-low-iron'):
    """
    Return real part of refractive index for glass given an array of
    wavelengths.

    Data for Soda-lime glass from:
     https://refractiveindex.info/?shelf=glass&book=soda-lime&page=Rubin-lowiron

    The data is modified so that the imaginary part of the refractive index is fixed
    at the minimum absorption (490 nm) from 490 up to 2600 nm.

    Rubin 1985. Range of validity is 310-4600 nm.

    Data for BK7 glass from:
        https://refractiveindex.info/?shelf=glass&book=BK7&page=SCHOTT

    Parameters
    ----------
    wavelength : ndarray
        wavelength in nm

    type : str
        Type of glass. Options are:

        'soda-lime-low-iron'

    Returns
    -------
    index_of_refraction : ndarray
        Index of refraction at specified wavelength.

    """

    if type.lower() == 'soda-lime-low-iron':
        # wavelength = wavelength / 1000
        # n = 1.5130 - 0.003169 * wavelength ** 2 + 0.003962 * wavelength ** -2 + 0 * 1j

        wavelength_real_n = [[0.3100, 1.5539233467171], [0.3529, 1.5444188160462], [0.3958, 1.5377943708226], [0.4387, 1.53297644448],
         [0.4816, 1.5293470967242], [0.5245, 1.5265302298432], [0.5674, 1.5242862988783], [0.6103, 1.5224568649146],
         [0.6532, 1.5209337417404], [0.6961, 1.5196410153786], [0.7390, 1.5185241450581], [0.7819, 1.5175431287183],
         [0.8248, 1.5166680887001], [0.8677, 1.515876345512], [0.9106, 1.5151504328084], [0.9535, 1.5144767228468],
         [0.9964, 1.5138444569151], [1.039, 1.5132491442474], [1.082, 1.5126742062569], [1.125, 1.5121197035108],
         [1.168, 1.5115809892876], [1.211, 1.5110542269085], [1.254, 1.5105362260091], [1.297, 1.5100243161568],
         [1.340, 1.5095162483895], [1.383, 1.50901011784], [1.425, 1.5085160727976], [1.468, 1.5080092235501],
         [1.511, 1.5075001334071], [1.554, 1.5069877679718], [1.597, 1.5064712302038], [1.640, 1.5059497390991],
         [1.683, 1.5054226121336], [1.726, 1.5048892507288], [1.769, 1.5043491281606], [1.812, 1.5038017794514],
         [1.854, 1.503259789112], [1.897, 1.5026969890414], [1.940, 1.5021258670852], [1.983, 1.5015461318092],
         [2.026, 1.5009575223743], [2.069, 1.5003598047618], [2.112, 1.4997527685307], [2.155, 1.4991362240238],
         [2.198, 1.498509999952], [2.241, 1.4978739413002], [2.283, 1.4972430458197], [2.326, 1.4965871455006],
         [2.369, 1.4959210287082], [2.412, 1.4952445892608], [2.455, 1.4945577301934], [2.498, 1.4938603628144],
         [2.541, 1.4931524058725], [2.584, 1.49243378482], [2.627, 1.49170443116], [2.670, 1.4909642818667],
         [2.712, 1.4902308677348], [2.755, 1.4894692116907], [2.798, 1.4886965999799], [2.841, 1.4879129867424],
         [2.884, 1.4871183295115], [2.927, 1.4863125889166], [2.970, 1.4854957284165], [3.013, 1.4846677140586],
         [3.056, 1.4838285142623], [3.099, 1.4829780996223], [3.141, 1.4821366091427], [3.184, 1.4812639467524],
         [3.227, 1.4803799932016], [3.270, 1.479484726137], [3.313, 1.4785781246463], [3.356, 1.4776601691481],
         [3.399, 1.476730841292], [3.442, 1.4757901238665], [3.485, 1.4748380007153], [3.528, 1.4738744566608],
         [3.570, 1.4729222813458], [3.613, 1.471936119913], [3.656, 1.4709384975263], [3.699, 1.4699294022586],
         [3.742, 1.4689088228641], [3.785, 1.467876748732], [3.828, 1.4668331698444], [3.871, 1.4657780767365],
         [3.914, 1.4647114604605], [3.957, 1.4636333125522], [3.999, 1.4625690976899], [4.042, 1.4614681315292],
         [4.085, 1.4603556111086], [4.128, 1.4592315296015], [4.171, 1.4580958805312], [4.214, 1.4569486577497],
         [4.257, 1.4557898554182], [4.300, 1.4546194679881], [4.343, 1.4534374901842], [4.386, 1.4522439169887],
         [4.428, 1.4510669026967], [4.471, 1.449850394547], [4.514, 1.4486222774501], [4.557, 1.4473825472731],
         [4.600, 1.4461312000756]]

        wavelength_k = np.array([[0.31, 1.191E-5], [0.32, 3.062E-6], [0.33, 1.399E-6], [0.34, 6.061E-7], [0.35, 2.458E-7], [0.36, 1.164E-7],
         [0.37, 9.300E-8], [0.38, 1.309E-7], [0.39, 6.261E-8], [0.40, 4.570E-8], [0.41, 5.013E-8], [0.42, 5.449E-8],
         [0.43, 5.878E-8], [0.44, 5.095E-8], [0.45, 4.252E-8], [0.46, 3.351E-8], [0.47, 3.675E-8], [0.48, 3.995E-8],
         [0.49, 2.972E-8], [0.50, 3.257E-8], [0.51, 3.538E-8], [0.52, 3.816E-8], [0.53, 4.091E-8], [0.54, 4.362E-8],
         [0.55, 4.632E-8], [0.56, 6.429E-8], [0.57, 6.721E-8], [0.58, 8.597E-8], [0.59, 8.913E-8], [0.60, 1.087E-7],
         [0.61, 1.121E-7], [0.62, 1.325E-7], [0.63, 1.534E-7], [0.64, 1.749E-7], [0.65, 1.790E-7], [0.66, 2.013E-7],
         [0.67, 2.242E-7], [0.68, 2.476E-7], [0.69, 2.526E-7], [0.70, 2.769E-7], [0.71, 3.017E-7], [0.72, 3.271E-7],
         [0.73, 3.531E-7], [0.74, 3.796E-7], [0.75, 4.067E-7], [0.76, 4.344E-7], [0.77, 4.627E-7], [0.78, 4.916E-7],
         [0.79, 5.210E-7], [0.80, 5.510E-7], [0.81, 5.816E-7], [0.82, 6.128E-7], [0.83, 6.446E-7], [0.84, 6.770E-7],
         [0.85, 7.099E-7], [0.86, 7.193E-7], [0.87, 7.513E-7], [0.88, 7.875E-7], [0.89, 7.975E-7], [0.90, 8.328E-7],
         [0.91, 8.430E-7], [0.92, 8.792E-7], [0.93, 8.897E-7], [0.94, 9.002E-7], [0.95, 9.376E-7], [0.96, 9.484E-7],
         [0.97, 9.592E-7], [0.98, 9.977E-7], [0.99, 1.009E-6], [1.00, 1.020E-6], [1.10, 1.132E-6], [1.20, 1.210E-6],
         [1.30, 1.211E-6], [1.40, 1.118E-6], [1.50, 9.585E-7], [1.60, 8.129E-7], [1.70, 8.301E-7], [1.80, 9.432E-7],
         [1.90, 1.117E-6], [2.00, 1.471E-6], [2.10, 1.739E-6], [2.20, 2.027E-6], [2.30, 2.401E-6], [2.40, 2.868E-6],
         [2.50, 3.441E-6], [2.60, 5.643E-6], [2.70, 9.156E-6], [2.80, 8.560E-5], [2.90, 9.745E-5], [3.00, 9.318E-5],
         [3.10, 9.489E-5], [3.20, 1.025E-4], [3.30, 1.128E-4], [3.40, 1.250E-4], [3.50, 1.299E-4], [3.60, 1.333E-4],
         [3.70, 1.319E-4], [3.80, 1.282E-4], [3.90, 1.242E-4], [4.00, 1.267E-4], [4.10, 1.460E-4], [4.20, 1.691E-4],
         [4.30, 2.124E-4], [4.40, 2.810E-4], [4.50, 3.657E-4], [4.60, 1.054E-3]])

        # Fix to lower absorption
        wavelength_k[np.logical_and(wavelength_k[:,0]>0.490, wavelength_k[:,0] < 2.600),1] = 2.972E-8

        real_n = np.interp(wavelength, 1e3 * np.array(wavelength_real_n)[:, 0], np.array(wavelength_real_n)[:, 1],left=1.5539233467171,right=1.4473825472731)
        imag_n = np.interp(wavelength, 1e3 * np.array(wavelength_k)[:, 0], np.array(wavelength_k)[:, 1],left=1.191E-5,right=1.054E-3)

        n = real_n + 1j * imag_n

        # n[wavelength < 0.3] = n[wavelength < 0.3] + 1j*0
    elif type.upper() == 'BK7':
        wavelength = wavelength / 1000
        n = np.sqrt(1 + \
                    (1.03961212 * wavelength ** 2) / (
                            wavelength ** 2 - 0.00600069867) + \
                    (0.231792344 * wavelength ** 2) / (
                            wavelength ** 2 - 0.0200179144) + \
                    (1.01046945 * wavelength ** 2) / (
                            wavelength ** 2 - 103.560653)
                    )

    return n


def refractive_index_ito(wavelength):


    wavelength_real_n = [[0.2, 2.31717213],[0.25157, 2.31717213], [0.25316, 2.33168536], [0.25475, 2.34626565], [0.25634, 2.36067795], [0.25793, 2.37467908],
     [0.25952, 2.38802531], [0.26112, 2.40048438], [0.26271, 2.41184546], [0.26430, 2.42192779], [0.26589, 2.43058781],
     [0.26748, 2.43772396], [0.26907, 2.44327819], [0.27067, 2.44723468], [0.27226, 2.44961670], [0.27385, 2.45048120],
     [0.27544, 2.44991257], [0.27703, 2.44801587], [0.27862, 2.44491010], [0.28022, 2.44072204], [0.28181, 2.43558114],
     [0.28340, 2.42961505], [0.28499, 2.42294624], [0.28658, 2.41568999], [0.28818, 2.40795253], [0.28977, 2.39983020],
     [0.29136, 2.39140949], [0.29295, 2.38276689], [0.29454, 2.37396931], [0.29614, 2.36507480], [0.29773, 2.35613305],
     [0.29932, 2.34718664], [0.30091, 2.33827137], [0.30250, 2.32941721], [0.30409, 2.32064883], [0.30569, 2.31198686],
     [0.30728, 2.30344754], [0.30887, 2.29504418], [0.31046, 2.28678728], [0.31205, 2.27868456], [0.31365, 2.27074208],
     [0.31524, 2.26296411], [0.31683, 2.25535349], [0.31842, 2.24791192], [0.32001, 2.24064001], [0.32161, 2.23353796],
     [0.32320, 2.22660502], [0.32479, 2.21984006], [0.32638, 2.21324163], [0.32797, 2.20680801], [0.32957, 2.20053745],
     [0.33116, 2.19442784], [0.33275, 2.18847739], [0.33434, 2.18268445], [0.33593, 2.17704736], [0.33752, 2.17156519],
     [0.33912, 2.16623741], [0.34071, 2.16106461], [0.34230, 2.15604930], [0.34389, 2.15119877], [0.34548, 2.14653759],
     [0.34708, 2.14204552], [0.34867, 2.13769101], [0.35026, 2.13345877], [0.35185, 2.12933779], [0.35344, 2.12531947],
     [0.35504, 2.12139667], [0.35663, 2.11756330], [0.35822, 2.11381409], [0.35981, 2.11014433], [0.36140, 2.10654969],
     [0.36299, 2.10302647], [0.36459, 2.09957119], [0.36618, 2.09618057], [0.36777, 2.09285183], [0.36936, 2.08958211],
     [0.37095, 2.08636899], [0.37254, 2.08321014], [0.37414, 2.08010332], [0.37573, 2.07704647], [0.37732, 2.07403771],
     [0.37891, 2.07107518], [0.38050, 2.06815721], [0.38210, 2.06528218], [0.38369, 2.06244853], [0.38528, 2.05965483],
     [0.38687, 2.05689966], [0.38846, 2.05418175], [0.39005, 2.05149982], [0.39164, 2.04885270], [0.39324, 2.04623925],
     [0.39483, 2.04365836], [0.39642, 2.04110902], [0.39801, 2.03859023], [0.39960, 2.03610099], [0.40119, 2.03364043],
     [0.40279, 2.03120768], [0.40438, 2.02880188], [0.40597, 2.02642218], [0.40756, 2.02406784], [0.40915, 2.02173811],
     [0.41074, 2.01943226], [0.41233, 2.01714956], [0.41393, 2.01488934], [0.41552, 2.01265101], [0.41711, 2.01043395],
     [0.41870, 2.00823747], [0.42029, 2.00606101], [0.42188, 2.00390405], [0.42347, 2.00176598], [0.42506, 1.99964634],
     [0.42665, 1.99754454], [0.42825, 1.99546010], [0.42984, 1.99339266], [0.43143, 1.99134156], [0.43302, 1.98930647],
     [0.43461, 1.98728696], [0.43620, 1.98528254], [0.43779, 1.98329279], [0.43938, 1.98131737], [0.44097, 1.97935590],
     [0.44257, 1.97740793], [0.44416, 1.97547316], [0.44575, 1.97355117], [0.44734, 1.97164168], [0.44893, 1.96974428],
     [0.45052, 1.96785870], [0.45211, 1.96598463], [0.45370, 1.96412169], [0.45529, 1.96226965], [0.45688, 1.96042814],
     [0.45847, 1.95859694], [0.46006, 1.95677571], [0.46165, 1.95496423], [0.46324, 1.95316225], [0.46484, 1.95136949],
     [0.46643, 1.94958565], [0.46802, 1.94781049], [0.46961, 1.94604388], [0.47120, 1.94428546], [0.47279, 1.94253502],
     [0.47438, 1.94079243], [0.47597, 1.93905737], [0.47756, 1.93732964], [0.47915, 1.93560912], [0.48074, 1.93389551],
     [0.48233, 1.93218866], [0.48392, 1.93048833], [0.48551, 1.92879438], [0.48710, 1.92710663], [0.48869, 1.92542489],
     [0.49028, 1.92374899], [0.49187, 1.92207870], [0.49346, 1.92041391], [0.49505, 1.91875441], [0.49664, 1.91710012],
     [0.49823, 1.91545079], [0.49982, 1.91380632], [0.50141, 1.91216656], [0.50300, 1.91053135], [0.50459, 1.90890051],
     [0.50618, 1.90727398], [0.50777, 1.90565154], [0.50936, 1.90403310], [0.51094, 1.90241851], [0.51253, 1.90080761],
     [0.51412, 1.89920036], [0.51571, 1.89759653], [0.51730, 1.89599606], [0.51889, 1.89439883], [0.52048, 1.89280471],
     [0.52207, 1.89121359], [0.52366, 1.88962536], [0.52525, 1.88803986], [0.52684, 1.88645706], [0.52843, 1.88487678],
     [0.53002, 1.88329900], [0.53160, 1.88172353], [0.53319, 1.88015030], [0.53478, 1.87857922], [0.53637, 1.87701019],
     [0.53796, 1.87544312], [0.53955, 1.87387791], [0.54114, 1.87231447], [0.54273, 1.87075271], [0.54431, 1.86919254],
     [0.54590, 1.86763388], [0.54749, 1.86607663], [0.54908, 1.86452071], [0.55067, 1.86296604], [0.55226, 1.86141254],
     [0.55384, 1.85986012], [0.55543, 1.85830872], [0.55702, 1.85675824], [0.55861, 1.85520862], [0.56020, 1.85365978],
     [0.56178, 1.85211170], [0.56337, 1.85056420], [0.56496, 1.84901726], [0.56655, 1.84747086], [0.56814, 1.84592483],
     [0.56972, 1.84437921], [0.57131, 1.84283388], [0.57290, 1.84128872], [0.57449, 1.83974377], [0.57607, 1.83819890],
     [0.57766, 1.83665412], [0.57925, 1.83510926], [0.58084, 1.83356430], [0.58242, 1.83201924], [0.58401, 1.83047397],
     [0.58560, 1.82892843], [0.58718, 1.82738256], [0.58877, 1.82583630], [0.59036, 1.82428966], [0.59195, 1.82274246],
     [0.59353, 1.82119477], [0.59512, 1.81964647], [0.59671, 1.81809757], [0.59829, 1.81654791], [0.59988, 1.81499753],
     [0.60147, 1.81344635], [0.60305, 1.81189430], [0.60464, 1.81034139], [0.60623, 1.80878748], [0.60781, 1.80723261],
     [0.60940, 1.80567673], [0.61098, 1.80411970], [0.61257, 1.80256157], [0.61416, 1.80100225], [0.61574, 1.79944173],
     [0.61733, 1.79787989], [0.61891, 1.79631676], [0.62050, 1.79475232], [0.62209, 1.79318641], [0.62367, 1.79161909],
     [0.62526, 1.79005032], [0.62684, 1.78847996], [0.62843, 1.78690807], [0.63001, 1.78533461], [0.63160, 1.78375948],
     [0.63318, 1.78218266], [0.63477, 1.78060409], [0.63635, 1.77902379], [0.63794, 1.77744167], [0.63952, 1.77585774],
     [0.64111, 1.77427191], [0.64269, 1.77268421], [0.64428, 1.77109453], [0.64586, 1.76950285], [0.64745, 1.76790917],
     [0.64903, 1.76631342], [0.65062, 1.76471561], [0.65220, 1.76311564], [0.65379, 1.76151354], [0.65537, 1.75990922],
     [0.65696, 1.75830270], [0.65854, 1.75669389], [0.66012, 1.75508276], [0.66171, 1.75346933], [0.66329, 1.75185356],
     [0.66488, 1.75023537], [0.66646, 1.74861478], [0.66804, 1.74699171], [0.66963, 1.74536611], [0.67121, 1.74373807],
     [0.67279, 1.74210740], [0.67438, 1.74047422], [0.67596, 1.73883840], [0.67754, 1.73719990], [0.67913, 1.73555875],
     [0.68071, 1.73391492], [0.68229, 1.73226832], [0.68388, 1.73061898], [0.68546, 1.72896681], [0.68704, 1.72731184],
     [0.68862, 1.72565404], [0.69021, 1.72399333], [0.69179, 1.72232972], [0.69337, 1.72066320], [0.69495, 1.71899368],
     [0.69654, 1.71732118], [0.69812, 1.71564562], [0.69970, 1.71396708], [0.70128, 1.71228538], [0.70287, 1.71060065],
     [0.70445, 1.70891274], [0.70603, 1.70722169], [0.70761, 1.70552747], [0.70919, 1.70383000], [0.71077, 1.70212930],
     [0.71236, 1.70042535], [0.71394, 1.69871811], [0.71552, 1.69700752], [0.71710, 1.69529360], [0.71868, 1.69357632],
     [0.72026, 1.69185559], [0.72184, 1.69013145], [0.72342, 1.68840388], [0.72500, 1.68667284], [0.72659, 1.68493830],
     [0.72817, 1.68320020], [0.72975, 1.68145861], [0.73133, 1.67971339], [0.73291, 1.67796452], [0.73449, 1.67621209],
     [0.73607, 1.67445601], [0.73765, 1.67269620], [0.73923, 1.67093269], [0.74081, 1.66916546], [0.74239, 1.66739449],
     [0.74397, 1.66561973], [0.74555, 1.66384113], [0.74713, 1.66205875], [0.74871, 1.66027247], [0.75029, 1.65848237],
     [0.75186, 1.65668831], [0.75344, 1.65489032], [0.75502, 1.65308839], [0.75660, 1.65128248], [0.75818, 1.64947257],
     [0.75976, 1.64765857], [0.76134, 1.64584058], [0.76292, 1.64401852], [0.76450, 1.64219229], [0.76607, 1.64036200],
     [0.76765, 1.63852750], [0.76923, 1.63668888], [0.77081, 1.63484600], [0.77239, 1.63299896], [0.77396, 1.63114760],
     [0.77554, 1.62929203], [0.77712, 1.62743215], [0.77870, 1.62556789], [0.78028, 1.62369934], [0.78185, 1.62182635],
     [0.78343, 1.61994902], [0.78501, 1.61806727], [0.78659, 1.61618100], [0.78816, 1.61429032], [0.78974, 1.61239513],
     [0.79132, 1.61049542], [0.79289, 1.60859115], [0.79447, 1.60668231], [0.79605, 1.60476887], [0.79762, 1.60285079],
     [0.79920, 1.60092812], [0.80077, 1.59900072], [0.80235, 1.59706866], [0.80393, 1.59513188], [0.80550, 1.59319034],
     [0.80708, 1.59124402], [0.80865, 1.58929290], [0.81023, 1.58733694], [0.81181, 1.58537618], [0.81338, 1.58341053],
     [0.81496, 1.58143992], [0.81653, 1.57946449], [0.81811, 1.57748403], [0.81968, 1.57549865], [0.82126, 1.57350819],
     [0.82283, 1.57151268], [0.82441, 1.56951223], [0.82598, 1.56750669], [0.82755, 1.56549590], [0.82913, 1.56348008],
     [0.83070, 1.56145909], [0.83228, 1.55943302], [0.83385, 1.55740160], [0.83543, 1.55536492], [0.83700, 1.55332308],
     [0.83857, 1.55127592], [0.84015, 1.54922331], [0.84172, 1.54716545], [0.84329, 1.54510232], [0.84487, 1.54303365],
     [0.84644, 1.54095952], [0.84801, 1.53888004], [0.84959, 1.53679506], [0.85116, 1.53470454], [0.85273, 1.53260845],
     [0.85430, 1.53050677], [0.85588, 1.52839960], [0.85745, 1.52628665], [0.85902, 1.52416815], [0.86059, 1.52204394],
     [0.86216, 1.51991412], [0.86374, 1.51777841], [0.86531, 1.51563702], [0.86688, 1.51348981], [0.86845, 1.51133674],
     [0.87002, 1.50917778], [0.87159, 1.50701291], [0.87316, 1.50484221], [0.87474, 1.50266554], [0.87631, 1.50048286],
     [0.87788, 1.49829426], [0.87945, 1.49609946], [0.88102, 1.49389869], [0.88259, 1.49169178], [0.88416, 1.48947884],
     [0.88573, 1.48725957], [0.88730, 1.48503419], [0.88887, 1.48280255], [0.89044, 1.48056461], [0.89201, 1.47832047],
     [0.89358, 1.47606997], [0.89515, 1.47381308], [0.89672, 1.47154989], [0.89829, 1.46928009], [0.89986, 1.46700393],
     [0.90142, 1.46472124], [0.90299, 1.46243212], [0.90456, 1.46013639], [0.90613, 1.45783403], [0.90770, 1.45552498],
     [0.90927, 1.45320938], [0.91083, 1.45088702], [0.91240, 1.44855788], [0.91397, 1.44622207], [0.91554, 1.44387940],
     [0.91711, 1.44152984], [0.91867, 1.43917349], [0.92024, 1.43681018], [0.92181, 1.43443985], [0.92338, 1.43206263],
     [0.92494, 1.42967833], [0.92651, 1.42728691], [0.92808, 1.42488832], [0.92964, 1.42248269], [0.93121, 1.42006996],
     [0.93278, 1.41764980], [0.93434, 1.41522247], [0.93591, 1.41278793], [0.93747, 1.41034584], [0.93904, 1.40789645],
     [0.94061, 1.40543973], [0.94217, 1.40297548], [0.94374, 1.40050366], [0.94530, 1.39802422], [0.94687, 1.39553728],
     [0.94843, 1.39304279], [0.95000, 1.39054056], [0.95156, 1.38803054], [0.95313, 1.38551268], [0.95469, 1.38298710],
     [0.95625, 1.38045359], [0.95782, 1.37791226], [0.95938, 1.37536292], [0.96095, 1.37280567], [0.96251, 1.37024030],
     [0.96407, 1.36766677], [0.96564, 1.36508519], [0.96720, 1.36249535], [0.96876, 1.35989737], [0.97033, 1.35729102],
     [0.97189, 1.35467642], [0.97345, 1.35205337], [0.97502, 1.34942180], [0.97658, 1.34678183], [0.97814, 1.34413341],
     [0.97970, 1.34147616], [0.98126, 1.33881051], [0.98283, 1.33613592], [0.98439, 1.33345283], [0.98595, 1.33076069],
     [0.98751, 1.32805977], [0.98907, 1.32535001], [0.99063, 1.32263121], [0.99220, 1.31990345], [0.99376, 1.31716652],
     [0.99532, 1.31442054], [0.99688, 1.31166526], [0.99844, 1.30890062], [1.00000, 1.30612675],
                         [2.00000, 1.30612675]]

    wavelength_k = [[0.2, 0.57780161], [0.25157, 0.57780161], [0.25316, 0.56970180], [0.25475, 0.56007881], [0.25634, 0.54889135], [0.25793, 0.53614073],
     [0.25952, 0.52187509], [0.26112, 0.50618770], [0.26271, 0.48921377], [0.26430, 0.47112495], [0.26589, 0.45212117],
     [0.26748, 0.43242053], [0.26907, 0.41224902], [0.27067, 0.39183166], [0.27226, 0.37138252], [0.27385, 0.35109896],
     [0.27544, 0.33115524], [0.27703, 0.31170070], [0.27862, 0.29285750], [0.28022, 0.27472102], [0.28181, 0.25736217],
     [0.28340, 0.24082882], [0.28499, 0.22514871], [0.28658, 0.21033313], [0.28818, 0.19637917], [0.28977, 0.18327257],
     [0.29136, 0.17099093], [0.29295, 0.15950523], [0.29454, 0.14878200], [0.29614, 0.13878487], [0.29773, 0.12947571],
     [0.29932, 0.12081606], [0.30091, 0.11276749], [0.30250, 0.10529233], [0.30409, 0.09835399], [0.30569, 0.09191767],
     [0.30728, 0.08594986], [0.30887, 0.08041911], [0.31046, 0.07529582], [0.31205, 0.07055199], [0.31365, 0.06616167],
     [0.31524, 0.06210060], [0.31683, 0.05834620], [0.31842, 0.05487750], [0.32001, 0.05167501], [0.32161, 0.04872078],
     [0.32320, 0.04599807], [0.32479, 0.04349141], [0.32638, 0.04118649], [0.32797, 0.03907008], [0.32957, 0.03712992],
     [0.33116, 0.03535462], [0.33275, 0.03373370], [0.33434, 0.03225743], [0.33593, 0.03091675], [0.33752, 0.02970331],
     [0.33912, 0.02860932], [0.34071, 0.02762754], [0.34230, 0.02675124], [0.34389, 0.02597410], [0.34548, 0.02527487],
     [0.34708, 0.02460068], [0.34867, 0.02394716], [0.35026, 0.02331379], [0.35185, 0.02269999], [0.35344, 0.02210520],
     [0.35504, 0.02152882], [0.35663, 0.02097030], [0.35822, 0.02042909], [0.35981, 0.01990462], [0.36140, 0.01939637],
     [0.36299, 0.01890381], [0.36459, 0.01842644], [0.36618, 0.01796376], [0.36777, 0.01751532], [0.36936, 0.01708062],
     [0.37095, 0.01665925], [0.37254, 0.01625075], [0.37414, 0.01585471], [0.37573, 0.01547072], [0.37732, 0.01509839],
     [0.37891, 0.01473735], [0.38050, 0.01438722], [0.38210, 0.01404766], [0.38369, 0.01371832], [0.38528, 0.01339886],
     [0.38687, 0.01308897], [0.38846, 0.01278834], [0.39005, 0.01249668], [0.39164, 0.01221369], [0.39324, 0.01193909],
     [0.39483, 0.01167263], [0.39642, 0.01141403], [0.39801, 0.01116305], [0.39960, 0.01091945], [0.40119, 0.01068299],
     [0.40279, 0.01045345], [0.40438, 0.01023061], [0.40597, 0.01001426], [0.40756, 0.00980420], [0.40915, 0.00960023],
     [0.41074, 0.00940216], [0.41233, 0.00920981], [0.41393, 0.00902299], [0.41552, 0.00884156], [0.41711, 0.00866533],
     [0.41870, 0.00849415], [0.42029, 0.00832786], [0.42188, 0.00816632], [0.42347, 0.00800938], [0.42506, 0.00785691],
     [0.42665, 0.00770876], [0.42825, 0.00756481], [0.42984, 0.00742495], [0.43143, 0.00728903], [0.43302, 0.00715695],
     [0.43461, 0.00702859], [0.43620, 0.00690385], [0.43779, 0.00678262], [0.43938, 0.00666480], [0.44097, 0.00655029],
     [0.44257, 0.00643898], [0.44416, 0.00633080], [0.44575, 0.00622565], [0.44734, 0.00612345], [0.44893, 0.00602411],
     [0.45052, 0.00592755], [0.45211, 0.00583369], [0.45370, 0.00574246], [0.45529, 0.00565378], [0.45688, 0.00556759],
     [0.45847, 0.00548381], [0.46006, 0.00540237], [0.46165, 0.00532322], [0.46324, 0.00524630], [0.46484, 0.00517153],
     [0.46643, 0.00509887], [0.46802, 0.00502825], [0.46961, 0.00495963], [0.47120, 0.00489295], [0.47279, 0.00482815],
     [0.47438, 0.00476519], [0.47597, 0.00470403], [0.47756, 0.00464460], [0.47915, 0.00458687], [0.48074, 0.00453080],
     [0.48233, 0.00447634], [0.48392, 0.00442345], [0.48551, 0.00437210], [0.48710, 0.00432223], [0.48869, 0.00427382],
     [0.49028, 0.00422683], [0.49187, 0.00418123], [0.49346, 0.00413697], [0.49505, 0.00409403], [0.49664, 0.00405237],
     [0.49823, 0.00401197], [0.49982, 0.00397279], [0.50141, 0.00393480], [0.50300, 0.00389798], [0.50459, 0.00386230],
     [0.50618, 0.00382773], [0.50777, 0.00379424], [0.50936, 0.00376182], [0.51094, 0.00373043], [0.51253, 0.00370005],
     [0.51412, 0.00367066], [0.51571, 0.00364224], [0.51730, 0.00361476], [0.51889, 0.00358821], [0.52048, 0.00356256],
     [0.52207, 0.00353779], [0.52366, 0.00351389], [0.52525, 0.00349084], [0.52684, 0.00346861], [0.52843, 0.00344719],
     [0.53002, 0.00342657], [0.53160, 0.00340672], [0.53319, 0.00338763], [0.53478, 0.00336929], [0.53637, 0.00335167],
     [0.53796, 0.00333477], [0.53955, 0.00331857], [0.54114, 0.00330305], [0.54273, 0.00328821], [0.54431, 0.00327403],
     [0.54590, 0.00326049], [0.54749, 0.00324759], [0.54908, 0.00323530], [0.55067, 0.00322363], [0.55226, 0.00321256],
     [0.55384, 0.00320207], [0.55543, 0.00319216], [0.55702, 0.00318282], [0.55861, 0.00317403], [0.56020, 0.00316579],
     [0.56178, 0.00315808], [0.56337, 0.00315090], [0.56496, 0.00314424], [0.56655, 0.00313808], [0.56814, 0.00313243],
     [0.56972, 0.00312727], [0.57131, 0.00312259], [0.57290, 0.00311838], [0.57449, 0.00311465], [0.57607, 0.00311137],
     [0.57766, 0.00310855], [0.57925, 0.00310617], [0.58084, 0.00310424], [0.58242, 0.00310273], [0.58401, 0.00310165],
     [0.58560, 0.00310099], [0.58718, 0.00310074], [0.58877, 0.00310090], [0.59036, 0.00310146], [0.59195, 0.00310242],
     [0.59353, 0.00310377], [0.59512, 0.00310550], [0.59671, 0.00310761], [0.59829, 0.00311010], [0.59988, 0.00311295],
     [0.60147, 0.00311617], [0.60305, 0.00311975], [0.60464, 0.00312369], [0.60623, 0.00312797], [0.60781, 0.00313260],
     [0.60940, 0.00313758], [0.61098, 0.00314289], [0.61257, 0.00314854], [0.61416, 0.00315452], [0.61574, 0.00316083],
     [0.61733, 0.00316746], [0.61891, 0.00317441], [0.62050, 0.00318168], [0.62209, 0.00318926], [0.62367, 0.00319715],
     [0.62526, 0.00320535], [0.62684, 0.00321385], [0.62843, 0.00322265], [0.63001, 0.00323175], [0.63160, 0.00324114],
     [0.63318, 0.00325083], [0.63477, 0.00326081], [0.63635, 0.00327107], [0.63794, 0.00328163], [0.63952, 0.00329246],
     [0.64111, 0.00330357], [0.64269, 0.00331496], [0.64428, 0.00332663], [0.64586, 0.00333857], [0.64745, 0.00335078],
     [0.64903, 0.00336327], [0.65062, 0.00337602], [0.65220, 0.00338903], [0.65379, 0.00340231], [0.65537, 0.00341586],
     [0.65696, 0.00342966], [0.65854, 0.00344372], [0.66012, 0.00345805], [0.66171, 0.00347262], [0.66329, 0.00348745],
     [0.66488, 0.00350254], [0.66646, 0.00351788], [0.66804, 0.00353346], [0.66963, 0.00354930], [0.67121, 0.00356539],
     [0.67279, 0.00358172], [0.67438, 0.00359830], [0.67596, 0.00361512], [0.67754, 0.00363219], [0.67913, 0.00364950],
     [0.68071, 0.00366705], [0.68229, 0.00368485], [0.68388, 0.00370288], [0.68546, 0.00372115], [0.68704, 0.00373966],
     [0.68862, 0.00375841], [0.69021, 0.00377740], [0.69179, 0.00379662], [0.69337, 0.00381608], [0.69495, 0.00383578],
     [0.69654, 0.00385571], [0.69812, 0.00387587], [0.69970, 0.00389627], [0.70128, 0.00391690], [0.70287, 0.00393776],
     [0.70445, 0.00395886], [0.70603, 0.00398019], [0.70761, 0.00400175], [0.70919, 0.00402354], [0.71077, 0.00404557],
     [0.71236, 0.00406782], [0.71394, 0.00409030], [0.71552, 0.00411302], [0.71710, 0.00413597], [0.71868, 0.00415914],
     [0.72026, 0.00418255], [0.72184, 0.00420619], [0.72342, 0.00423006], [0.72500, 0.00425416], [0.72659, 0.00427848],
     [0.72817, 0.00430304], [0.72975, 0.00432783], [0.73133, 0.00435285], [0.73291, 0.00437810], [0.73449, 0.00440358],
     [0.73607, 0.00442929], [0.73765, 0.00445524], [0.73923, 0.00448141], [0.74081, 0.00450782], [0.74239, 0.00453445],
     [0.74397, 0.00456132], [0.74555, 0.00458843], [0.74713, 0.00461576], [0.74871, 0.00464333], [0.75029, 0.00467113],
     [0.75186, 0.00469916], [0.75344, 0.00472743], [0.75502, 0.00475594], [0.75660, 0.00478468], [0.75818, 0.00481365],
     [0.75976, 0.00484287], [0.76134, 0.00487231], [0.76292, 0.00490200], [0.76450, 0.00493192], [0.76607, 0.00496209],
     [0.76765, 0.00499249], [0.76923, 0.00502313], [0.77081, 0.00505401], [0.77239, 0.00508513], [0.77396, 0.00511650],
     [0.77554, 0.00514810], [0.77712, 0.00517995], [0.77870, 0.00521204], [0.78028, 0.00524438], [0.78185, 0.00527697],
     [0.78343, 0.00530980], [0.78501, 0.00534287], [0.78659, 0.00537620], [0.78816, 0.00540978], [0.78974, 0.00544360],
     [0.79132, 0.00547768], [0.79289, 0.00551200], [0.79447, 0.00554658], [0.79605, 0.00558142], [0.79762, 0.00561651],
     [0.79920, 0.00565185], [0.80077, 0.00568745], [0.80235, 0.00572331], [0.80393, 0.00575942], [0.80550, 0.00579580],
     [0.80708, 0.00583244], [0.80865, 0.00586934], [0.81023, 0.00590651], [0.81181, 0.00594393], [0.81338, 0.00598163],
     [0.81496, 0.00601959], [0.81653, 0.00605782], [0.81811, 0.00609632], [0.81968, 0.00613509], [0.82126, 0.00617413],
     [0.82283, 0.00621345], [0.82441, 0.00625304], [0.82598, 0.00629291], [0.82755, 0.00633305], [0.82913, 0.00637348],
     [0.83070, 0.00641418], [0.83228, 0.00645516], [0.83385, 0.00649643], [0.83543, 0.00653799], [0.83700, 0.00657983],
     [0.83857, 0.00662196], [0.84015, 0.00666438], [0.84172, 0.00670709], [0.84329, 0.00675009], [0.84487, 0.00679338],
     [0.84644, 0.00683698], [0.84801, 0.00688087], [0.84959, 0.00692506], [0.85116, 0.00696955], [0.85273, 0.00701434],
     [0.85430, 0.00705944], [0.85588, 0.00710485], [0.85745, 0.00715056], [0.85902, 0.00719659], [0.86059, 0.00724292],
     [0.86216, 0.00728957], [0.86374, 0.00733654], [0.86531, 0.00738382], [0.86688, 0.00743143], [0.86845, 0.00747936],
     [0.87002, 0.00752761], [0.87159, 0.00757619], [0.87316, 0.00762509], [0.87474, 0.00767433], [0.87631, 0.00772389],
     [0.87788, 0.00777380], [0.87945, 0.00782404], [0.88102, 0.00787462], [0.88259, 0.00792554], [0.88416, 0.00797680],
     [0.88573, 0.00802841], [0.88730, 0.00808037], [0.88887, 0.00813268], [0.89044, 0.00818534], [0.89201, 0.00823836],
     [0.89358, 0.00829174], [0.89515, 0.00834548], [0.89672, 0.00839958], [0.89829, 0.00845404], [0.89986, 0.00850888],
     [0.90142, 0.00856409], [0.90299, 0.00861967], [0.90456, 0.00867563], [0.90613, 0.00873196], [0.90770, 0.00878868],
     [0.90927, 0.00884579], [0.91083, 0.00890328], [0.91240, 0.00896117], [0.91397, 0.00901944], [0.91554, 0.00907812],
     [0.91711, 0.00913719], [0.91867, 0.00919667], [0.92024, 0.00925655], [0.92181, 0.00931685], [0.92338, 0.00937755],
     [0.92494, 0.00943867], [0.92651, 0.00950022], [0.92808, 0.00956218], [0.92964, 0.00962457], [0.93121, 0.00968739],
     [0.93278, 0.00975064], [0.93434, 0.00981433], [0.93591, 0.00987846], [0.93747, 0.00994303], [0.93904, 0.01000805],
     [0.94061, 0.01007352], [0.94217, 0.01013945], [0.94374, 0.01020583], [0.94530, 0.01027268], [0.94687, 0.01033999],
     [0.94843, 0.01040777], [0.95000, 0.01047603], [0.95156, 0.01054477], [0.95313, 0.01061399], [0.95469, 0.01068370],
     [0.95625, 0.01075390], [0.95782, 0.01082460], [0.95938, 0.01089579], [0.96095, 0.01096749], [0.96251, 0.01103970],
     [0.96407, 0.01111243], [0.96564, 0.01118567], [0.96720, 0.01125944], [0.96876, 0.01133373], [0.97033, 0.01140856],
     [0.97189, 0.01148392], [0.97345, 0.01155983], [0.97502, 0.01163629], [0.97658, 0.01171331], [0.97814, 0.01179087],
     [0.97970, 0.01186901], [0.98126, 0.01194771], [0.98283, 0.01202700], [0.98439, 0.01210686], [0.98595, 0.01218731],
     [0.98751, 0.01226835], [0.98907, 0.01234999], [0.99063, 0.01243223], [0.99220, 0.01251508], [0.99376, 0.01259855],
     [0.99532, 0.01268264], [0.99688, 0.01276737], [0.99844, 0.01285273], [1.00000, 0.01293873],
                    [2,0.01293873]]

    real_n = np.interp(wavelength, 1e3 * np.array(wavelength_real_n)[:, 0], np.array(wavelength_real_n)[:, 1],left=1.5539233467171,right=1.4473825472731)
    imag_n = np.interp(wavelength, 1e3 * np.array(wavelength_k)[:, 0], np.array(wavelength_k)[:, 1],left=1.191E-5,right=1.054E-3)

    n = real_n + 1j * imag_n

    return n


def refractive_index_porous_silica(wavelength, porosity=0.5, model='lookup'):
    """
    Calculates index of refraction for porous silica using the effective
    medium approximation and volume averaging theory.

    https://refractiveindex.info/?shelf=main&book=SiO2&page=Malitson

    Parameters
    ----------
    wavelength : numeric

        Wavelength in nm.

    porosity : float

        Fractional porosity, a number from 0 to 1.0.


    Returns
    -------

    index : numeric

        Refractive index

    """
    if model == 'analytic':
        wavelength_um = wavelength / 1000
        n = np.sqrt(1 + \
                    (0.6961663 * wavelength_um ** 2) / (
                            wavelength_um ** 2 - 0.06840432 ** 2) + \
                    (0.4079426 * wavelength_um ** 2) / (
                            wavelength_um ** 2 - 0.11624142 ** 2) + \
                    (0.8974794 * wavelength_um ** 2) / (
                            wavelength_um ** 2 - 9.8961612 ** 2)
                    )


    elif model=='lookup':
        wavelength_real_n = [[0.2100, 1.5383576204905], [0.2174, 1.530846431063], [0.2251, 1.5240789072975], [0.2330, 1.5180417677275],
         [0.2412, 1.5125721155558], [0.2497, 1.5076095872199], [0.2585, 1.5031009629039], [0.2676, 1.498999218542],
         [0.2770, 1.495262719426], [0.2868, 1.4918215034661], [0.2969, 1.488683281387], [0.3074, 1.4857914366574],
         [0.3182, 1.4831504333467], [0.3294, 1.4807144415912], [0.3410, 1.4784676522483], [0.3530, 1.4763951298847],
         [0.3655, 1.4744682820342], [0.3783, 1.4727046797948], [0.3917, 1.4710525123802], [0.4055, 1.4695286500209],
         [0.4197, 1.4681218218832], [0.4345, 1.4668048202486], [0.4498, 1.465580829975], [0.4657, 1.4644360310913],
         [0.4821, 1.4633719346282], [0.4991, 1.4623764385944], [0.5167, 1.4614449911601], [0.5349, 1.4605730794883],
         [0.5537, 1.4597562854765], [0.5732, 1.4589865613939], [0.5934, 1.4582607881284], [0.6143, 1.4575758068817],
         [0.6360, 1.4569256013294], [0.6584, 1.4563104080175], [0.6816, 1.4557246986958], [0.7056, 1.4551660299221],
         [0.7305, 1.4546298754538], [0.7562, 1.4541161650842], [0.7829, 1.4536188536247], [0.8104, 1.4531396102638],
         [0.8390, 1.4526712743322], [0.8686, 1.4522138205731], [0.8992, 1.4517653834747], [0.9308, 1.4513240787777],
         [0.9636, 1.4508853971281], [0.9976, 1.450447735732], [1.033, 1.4500069615101], [1.069, 1.4495710901504],
         [1.107, 1.4491214616538], [1.146, 1.448668310738], [1.186, 1.4482096590065], [1.228, 1.4477322458328],
         [1.271, 1.4472455774929], [1.316, 1.4467363524093], [1.362, 1.4462138519129], [1.410, 1.445664578157],
         [1.460, 1.4450861470109], [1.512, 1.4444759883488], [1.565, 1.4438434020915], [1.620, 1.4431739285381],
         [1.677, 1.4424645759259], [1.736, 1.4417121733672], [1.797, 1.4409133669095], [1.861, 1.4400509385522],
         [1.926, 1.43914806608], [1.994, 1.4381729429417], [2.064, 1.4371349603433], [2.137, 1.4360139618555],
         [2.212, 1.4348196176837], [2.290, 1.433529881253], [2.371, 1.4321372109342], [2.454, 1.4306516985468],
         [2.541, 1.4290287283802], [2.630, 1.427296093753], [2.723, 1.4254044329951], [2.819, 1.4233613684394],
         [2.918, 1.4211544161909], [3.021, 1.4187459519934], [3.128, 1.416117293379], [3.238, 1.4132741569442],
         [3.352, 1.4101696832452], [3.470, 1.4067782146466], [3.592, 1.4030708962299], [3.719, 1.3989819997456],
         [3.850, 1.3945035722002], [3.986, 1.3895553417944], [4.126, 1.3841208059058], [4.271, 1.3780997735118],
         [4.422, 1.3713701305288], [4.578, 1.36388143366], [4.739, 1.3555262189157], [4.906, 1.3461171232165],
         [5.079, 1.3354823573874], [5.258, 1.3234105439689], [5.443, 1.3096384003386], [5.635, 1.2937460280032],
         [5.833, 1.2753723963511], [6.039, 1.2537289561387], [6.252, 1.2280888354422], [6.472, 1.1973256716307],
         [6.700, 1.1596494139777]]
        n = np.interp(wavelength, 1e3 * np.array(wavelength_real_n)[:, 0], np.array(wavelength_real_n)[:, 1],
                           left= 1.5383576204905, right=1.1596494139777)


    n_air = 1.00029

    n_total = np.sqrt(n ** 2 * (1 - porosity) + n_air ** 2 * (porosity)) + 0 * 1j

    # k0 = 5e-6
    # k1 = 5e-7
    # wavelength0 = 0.31
    # wavelength1 = 0.36

    # n_total = n_total + 1j*refractive_index_imaginary_silica(wavelength)*1e4
    # n_total = n_total + 1j*np.exp( np.log(k0) + np.log(k1) * (wavelength - wavelength0)/(wavelength1-wavelength0))

    return n_total


def refractive_index_silicon(wavelength):
    """
    Refractive index for silicon

    Data from Green 2008:
    https://refractiveindex.info/?shelf=main&book=Si&page=Green-2008

    :param wavelength:
    :return:
    """
    wavelength_real_n = [[2.5000e-01, 1.6650e+00], [2.6000e-01, 1.7570e+00], [2.7000e-01, 2.0680e+00],
                         [2.8000e-01, 2.9590e+00], [2.9000e-01, 4.3560e+00], [3.0000e-01, 4.9760e+00],
                         [3.1000e-01, 5.1210e+00], [3.2000e-01, 5.1120e+00], [3.3000e-01, 5.1950e+00],
                         [3.4000e-01, 5.3010e+00], [3.5000e-01, 5.4940e+00], [3.6000e-01, 6.0260e+00],
                         [3.7000e-01, 6.8910e+00], [3.8000e-01, 6.6160e+00], [3.9000e-01, 6.0390e+00],
                         [4.0000e-01, 5.6130e+00], [4.1000e-01, 5.3300e+00], [4.2000e-01, 5.1190e+00],
                         [4.3000e-01, 4.9490e+00], [4.4000e-01, 4.8120e+00], [4.5000e-01, 4.6910e+00],
                         [4.6000e-01, 4.5870e+00], [4.7000e-01, 4.4970e+00], [4.8000e-01, 4.4190e+00],
                         [4.9000e-01, 4.3500e+00], [5.0000e-01, 4.2940e+00], [5.1000e-01, 4.2410e+00],
                         [5.2000e-01, 4.1930e+00], [5.3000e-01, 4.1510e+00], [5.4000e-01, 4.1120e+00],
                         [5.5000e-01, 4.0770e+00], [5.6000e-01, 4.0450e+00], [5.7000e-01, 4.0150e+00],
                         [5.8000e-01, 3.9880e+00], [5.9000e-01, 3.9630e+00], [6.0000e-01, 3.9400e+00],
                         [6.1000e-01, 3.9180e+00], [6.2000e-01, 3.8980e+00], [6.3000e-01, 3.8790e+00],
                         [6.4000e-01, 3.8610e+00], [6.5000e-01, 3.8440e+00], [6.6000e-01, 3.8280e+00],
                         [6.7000e-01, 3.8130e+00], [6.8000e-01, 3.7980e+00], [6.9000e-01, 3.7840e+00],
                         [7.0000e-01, 3.7720e+00], [7.1000e-01, 3.7590e+00], [7.2000e-01, 3.7480e+00],
                         [7.3000e-01, 3.7370e+00], [7.4000e-01, 3.7270e+00], [7.5000e-01, 3.7170e+00],
                         [7.6000e-01, 3.7080e+00], [7.7000e-01, 3.6990e+00], [7.8000e-01, 3.6910e+00],
                         [7.9000e-01, 3.6830e+00], [8.0000e-01, 3.6750e+00], [8.1000e-01, 3.6680e+00],
                         [8.2000e-01, 3.6610e+00], [8.3000e-01, 3.6540e+00], [8.4000e-01, 3.6470e+00],
                         [8.5000e-01, 3.6410e+00], [8.6000e-01, 3.6350e+00], [8.7000e-01, 3.6300e+00],
                         [8.8000e-01, 3.6240e+00], [8.9000e-01, 3.6190e+00], [9.0000e-01, 3.6140e+00],
                         [9.1000e-01, 3.6090e+00], [9.2000e-01, 3.6040e+00], [9.3000e-01, 3.6000e+00],
                         [9.4000e-01, 3.5950e+00], [9.5000e-01, 3.5910e+00], [9.6000e-01, 3.5870e+00],
                         [9.7000e-01, 3.5830e+00], [9.8000e-01, 3.5790e+00], [9.9000e-01, 3.5750e+00],
                         [1.0000e+00, 3.5720e+00], [1.0100e+00, 3.5680e+00], [1.0200e+00, 3.5650e+00],
                         [1.0300e+00, 3.5620e+00], [1.0400e+00, 3.5590e+00], [1.0500e+00, 3.5560e+00],
                         [1.0600e+00, 3.5530e+00], [1.0700e+00, 3.5500e+00], [1.0800e+00, 3.5470e+00],
                         [1.0900e+00, 3.5450e+00], [1.1000e+00, 3.5420e+00], [1.1100e+00, 3.5400e+00],
                         [1.1200e+00, 3.5370e+00], [1.1300e+00, 3.5350e+00], [1.1400e+00, 3.5320e+00],
                         [1.1500e+00, 3.5300e+00], [1.1600e+00, 3.5280e+00], [1.1700e+00, 3.5260e+00],
                         [1.1800e+00, 3.5240e+00], [1.1900e+00, 3.5220e+00], [1.2000e+00, 3.5200e+00],
                         [1.2100e+00, 3.5180e+00], [1.2200e+00, 3.5170e+00], [1.2300e+00, 3.5150e+00],
                         [1.2400e+00, 3.5130e+00], [1.2500e+00, 3.5110e+00], [1.2600e+00, 3.5090e+00],
                         [1.2700e+00, 3.5080e+00], [1.2800e+00, 3.5060e+00], [1.2900e+00, 3.5050e+00],
                         [1.3000e+00, 3.5030e+00], [1.3100e+00, 3.5020e+00], [1.3200e+00, 3.5000e+00],
                         [1.3300e+00, 3.4990e+00], [1.3400e+00, 3.4970e+00], [1.3500e+00, 3.4960e+00],
                         [1.3600e+00, 3.4950e+00], [1.3700e+00, 3.4940e+00], [1.3800e+00, 3.4920e+00],
                         [1.3900e+00, 3.4910e+00], [1.4000e+00, 3.4900e+00], [1.4100e+00, 3.4890e+00],
                         [1.4200e+00, 3.4880e+00], [1.4300e+00, 3.4870e+00], [1.4400e+00, 3.4860e+00],
                         [1.4500e+00, 3.4850e+00]]

    wavelength_k = [[2.5000e-01, 3.6650e+00], [2.6000e-01, 4.0840e+00], [2.7000e-01, 4.6800e+00],
                    [2.8000e-01, 5.2870e+00], [2.9000e-01, 5.2860e+00], [3.0000e-01, 4.2340e+00],
                    [3.1000e-01, 3.5980e+00], [3.2000e-01, 3.3030e+00], [3.3000e-01, 3.1000e+00],
                    [3.4000e-01, 2.9770e+00], [3.5000e-01, 2.9380e+00], [3.6000e-01, 2.9660e+00],
                    [3.7000e-01, 2.1710e+00], [3.8000e-01, 9.4600e-01], [3.9000e-01, 4.4500e-01],
                    [4.0000e-01, 2.9600e-01], [4.1000e-01, 2.2700e-01], [4.2000e-01, 1.7600e-01],
                    [4.3000e-01, 1.3800e-01], [4.4000e-01, 1.0700e-01], [4.5000e-01, 8.6302e-02],
                    [4.6000e-01, 7.1381e-02], [4.7000e-01, 6.2086e-02], [4.8000e-01, 5.5004e-02],
                    [4.9000e-01, 4.9131e-02], [5.0000e-01, 4.4165e-02], [5.1000e-01, 3.9367e-02],
                    [5.2000e-01, 3.6415e-02], [5.3000e-01, 3.3108e-02], [5.4000e-01, 3.0295e-02],
                    [5.5000e-01, 2.7968e-02], [5.6000e-01, 2.5758e-02], [5.7000e-01, 2.4131e-02],
                    [5.8000e-01, 2.2524e-02], [5.9000e-01, 2.1081e-02], [6.0000e-01, 1.9934e-02],
                    [6.1000e-01, 1.8446e-02], [6.2000e-01, 1.7367e-02], [6.3000e-01, 1.6444e-02],
                    [6.4000e-01, 1.5432e-02], [6.5000e-01, 1.4431e-02], [6.6000e-01, 1.3498e-02],
                    [6.7000e-01, 1.2743e-02], [6.8000e-01, 1.1905e-02], [6.9000e-01, 1.1201e-02],
                    [7.0000e-01, 1.0528e-02], [7.1000e-01, 1.0057e-02], [7.2000e-01, 9.6257e-03],
                    [7.3000e-01, 8.9461e-03], [7.4000e-01, 8.3620e-03], [7.5000e-01, 7.8185e-03],
                    [7.6000e-01, 7.1970e-03], [7.7000e-01, 6.7402e-03], [7.8000e-01, 6.3933e-03],
                    [7.9000e-01, 5.8340e-03], [8.0000e-01, 5.4113e-03], [8.1000e-01, 4.9955e-03],
                    [8.2000e-01, 4.6134e-03], [8.3000e-01, 4.2734e-03], [8.4000e-01, 3.9439e-03],
                    [8.5000e-01, 3.6120e-03], [8.6000e-01, 3.2781e-03], [8.7000e-01, 2.9839e-03],
                    [8.8000e-01, 2.6821e-03], [8.9000e-01, 2.4293e-03], [9.0000e-01, 2.1701e-03],
                    [9.1000e-01, 1.9625e-03], [9.2000e-01, 1.7571e-03], [9.3000e-01, 1.5467e-03],
                    [9.4000e-01, 1.3689e-03], [9.5000e-01, 1.1793e-03], [9.6000e-01, 1.0237e-03],
                    [9.7000e-01, 8.7225e-04], [9.8000e-01, 7.4866e-04], [9.9000e-01, 6.2238e-04],
                    [1.0000e+00, 5.0930e-04], [1.0100e+00, 4.1071e-04], [1.0200e+00, 3.2386e-04],
                    [1.0300e+00, 2.4753e-04], [1.0400e+00, 1.8704e-04], [1.0500e+00, 1.3620e-04],
                    [1.0600e+00, 9.3631e-05], [1.0700e+00, 6.8118e-05], [1.0800e+00, 5.3285e-05],
                    [1.0900e+00, 4.0768e-05], [1.1000e+00, 3.0637e-05], [1.1100e+00, 2.3849e-05],
                    [1.1200e+00, 1.7825e-05], [1.1300e+00, 1.3488e-05], [1.1400e+00, 9.0718e-06],
                    [1.1500e+00, 6.2230e-06], [1.1600e+00, 3.8770e-06], [1.1700e+00, 2.0483e-06],
                    [1.1800e+00, 6.1036e-07], [1.1900e+00, 3.4091e-07], [1.2000e+00, 2.1008e-07],
                    [1.2100e+00, 1.2518e-07], [1.2200e+00, 7.9609e-08], [1.2300e+00, 4.6004e-08],
                    [1.2400e+00, 2.3682e-08], [1.2500e+00, 9.9472e-09], [1.2600e+00, 3.6096e-09],
                    [1.2700e+00, 2.0213e-09], [1.2800e+00, 1.2223e-09], [1.2900e+00, 7.2885e-10],
                    [1.3000e+00, 4.6553e-10], [1.3100e+00, 2.8147e-10], [1.3200e+00, 1.6807e-10],
                    [1.3300e+00, 8.4670e-11], [1.3400e+00, 3.7322e-11], [1.3500e+00, 1.8263e-11],
                    [1.3600e+00, 1.0281e-11], [1.3700e+00, 6.5413e-12], [1.3800e+00, 4.1730e-12],
                    [1.3900e+00, 2.5441e-12], [1.4000e+00, 1.5597e-12], [1.4100e+00, 9.5374e-13],
                    [1.4200e+00, 5.6500e-13], [1.4300e+00, 2.8449e-13], [1.4400e+00, 2.0626e-13],
                    [1.4500e+00, 1.3846e-13]]

    real_n = np.interp(wavelength, 1e3*np.array(wavelength_real_n)[:, 0], np.array(wavelength_real_n)[:, 1])
    imag_n = np.interp(wavelength, 1e3*np.array(wavelength_k)[:, 0], np.array(wavelength_k)[:, 1])

    n = real_n + 1j*imag_n

    return n

def refractive_index_eva(wavelength,uv_abs_factor=3):
    """
    UV Transparent EVA

    https://refractiveindex.info/?shelf=other&book=EVASKY_S87&page=Vogt


    :param wavelength:
    :return:
    """

    wavelength_real_n = [[0.25, 1.557], [0.26, 1.551], [0.27, 1.545], [0.28, 1.54], [0.29, 1.536], [0.3, 1.532],
                         [0.31, 1.528], [0.32, 1.525], [0.33, 1.522], [0.34, 1.519], [0.35, 1.517], [0.36, 1.515],
                         [0.37, 1.513], [0.38, 1.511], [0.39, 1.51], [0.4, 1.508], [0.41, 1.507], [0.42, 1.506],
                         [0.43, 1.505], [0.44, 1.504], [0.45, 1.503], [0.46, 1.502], [0.47, 1.501], [0.48, 1.5],
                         [0.49, 1.499], [0.5, 1.499], [0.51, 1.498], [0.52, 1.497], [0.53, 1.497], [0.54, 1.496],
                         [0.55, 1.496], [0.56, 1.495], [0.57, 1.495], [0.58, 1.494], [0.59, 1.494], [0.6, 1.493],
                         [0.61, 1.493], [0.62, 1.493], [0.63, 1.492], [0.64, 1.492], [0.65, 1.492], [0.66, 1.491],
                         [0.67, 1.491], [0.68, 1.491], [0.69, 1.491], [0.7, 1.49], [0.71, 1.49], [0.72, 1.49],
                         [0.73, 1.49], [0.74, 1.49], [0.75, 1.489], [0.76, 1.489], [0.77, 1.489], [0.78, 1.489],
                         [0.79, 1.489], [0.8, 1.488], [0.81, 1.488], [0.82, 1.488], [0.83, 1.488], [0.84, 1.488],
                         [0.85, 1.488], [0.86, 1.488], [0.87, 1.487], [0.88, 1.487], [0.89, 1.487], [0.9, 1.487],
                         [0.91, 1.487], [0.92, 1.487], [0.93, 1.487], [0.94, 1.487], [0.95, 1.487], [0.96, 1.487],
                         [0.97, 1.486], [0.98, 1.486], [0.99, 1.486], [1, 1.486], [1.01, 1.486], [1.02, 1.486],
                         [1.03, 1.486], [1.04, 1.486], [1.05, 1.486], [1.06, 1.486], [1.07, 1.486], [1.08, 1.486],
                         [1.09, 1.486], [1.1, 1.486], [1.11, 1.485], [1.12, 1.485], [1.13, 1.485], [1.14, 1.485],
                         [1.15, 1.485], [1.16, 1.485], [1.17, 1.485], [1.18, 1.485], [1.19, 1.485], [1.2, 1.485],
                         [1.21, 1.485], [1.22, 1.485], [1.23, 1.485], [1.24, 1.485], [1.25, 1.485], [1.26, 1.485],
                         [1.27, 1.485], [1.28, 1.485], [1.29, 1.485], [1.3, 1.485], [1.31, 1.485], [1.32, 1.485],
                         [1.33, 1.484], [1.34, 1.484], [1.35, 1.484], [1.36, 1.484], [1.37, 1.484], [1.38, 1.484],
                         [1.39, 1.484], [1.4, 1.484], [1.41, 1.484], [1.42, 1.484], [1.43, 1.484], [1.44, 1.484],
                         [1.45, 1.484], [1.46, 1.484], [1.47, 1.484], [1.48, 1.484], [1.49, 1.484], [1.5, 1.484],
                         [1.51, 1.484], [1.52, 1.484], [1.53, 1.484], [1.54, 1.484], [1.55, 1.484], [1.56, 1.484],
                         [1.57, 1.484], [1.58, 1.484], [1.59, 1.484], [1.6, 1.484], [1.61, 1.484], [1.62, 1.484],
                         [1.63, 1.484], [1.64, 1.484], [1.65, 1.484], [1.66, 1.484], [1.67, 1.484], [1.68, 1.484],
                         [1.69, 1.484], [1.7, 1.484], [1.71, 1.484], [1.72, 1.484], [1.73, 1.484], [1.74, 1.484],
                         [1.75, 1.484], [1.76, 1.484], [1.77, 1.484], [1.78, 1.484], [1.79, 1.483], [1.8, 1.483],
                         [1.81, 1.483], [1.82, 1.483], [1.83, 1.483], [1.84, 1.483], [1.85, 1.483], [1.86, 1.483],
                         [1.87, 1.483], [1.88, 1.483], [1.89, 1.483], [1.9, 1.483], [1.91, 1.483], [1.92, 1.483],
                         [1.93, 1.483], [1.94, 1.483], [1.95, 1.483], [1.96, 1.483], [1.97, 1.483], [1.98, 1.483],
                         [1.99, 1.483], [2, 1.483], [2.01, 1.483], [2.02, 1.483], [2.03, 1.483], [2.04, 1.483],
                         [2.05, 1.483], [2.06, 1.483], [2.07, 1.483], [2.08, 1.483], [2.09, 1.483], [2.1, 1.483],
                         [2.11, 1.483], [2.12, 1.483], [2.13, 1.483], [2.14, 1.483], [2.15, 1.483], [2.16, 1.483],
                         [2.17, 1.483], [2.18, 1.483], [2.19, 1.483], [2.2, 1.483], [2.21, 1.483], [2.22, 1.483],
                         [2.23, 1.483], [2.24, 1.483], [2.25, 1.483], [2.26, 1.483], [2.27, 1.483], [2.28, 1.483],
                         [2.29, 1.483], [2.3, 1.483], [2.31, 1.483], [2.32, 1.483], [2.33, 1.483], [2.34, 1.483],
                         [2.35, 1.483], [2.36, 1.483], [2.37, 1.483], [2.38, 1.483], [2.39, 1.483], [2.4, 1.483],
                         [2.41, 1.483], [2.42, 1.483], [2.43, 1.483], [2.44, 1.483], [2.45, 1.483], [2.46, 1.483],
                         [2.47, 1.483], [2.48, 1.483], [2.49, 1.483], [2.5, 1.483]]

    wavelength_k = [[0.25, 9.86E-06], [0.26, 9.70E-06], [0.27, 8.20E-06], [0.28, 6.64E-06], [0.29, 5.31E-06],
                    [0.3, 3.89E-06], [0.31, 3.11E-06], [0.32, 2.64E-06], [0.33, 2.28E-06], [0.34, 1.95E-06],
                    [0.35, 1.56E-06], [0.36, 1.27E-06], [0.37, 1.07E-06], [0.38, 9.48E-07], [0.39, 8.57E-07],
                    [0.4, 7.84E-07], [0.41, 7.37E-07], [0.42, 6.96E-07], [0.43, 6.62E-07], [0.44, 6.33E-07],
                    [0.45, 6.04E-07], [0.46, 5.78E-07], [0.47, 5.55E-07], [0.48, 5.32E-07], [0.49, 5.10E-07],
                    [0.5, 4.90E-07], [0.51, 4.70E-07], [0.52, 4.52E-07], [0.53, 4.33E-07], [0.54, 4.17E-07],
                    [0.55, 4.02E-07], [0.56, 3.87E-07], [0.57, 3.74E-07], [0.58, 3.58E-07], [0.59, 3.47E-07],
                    [0.6, 3.34E-07], [0.61, 3.23E-07], [0.62, 3.12E-07], [0.63, 3.03E-07], [0.64, 2.96E-07],
                    [0.65, 2.88E-07], [0.66, 2.74E-07], [0.67, 2.64E-07], [0.68, 2.56E-07], [0.69, 2.49E-07],
                    [0.7, 2.43E-07], [0.71, 2.36E-07], [0.72, 2.32E-07], [0.73, 2.32E-07], [0.74, 2.38E-07],
                    [0.75, 2.53E-07], [0.76, 2.59E-07], [0.77, 2.40E-07], [0.78, 2.10E-07], [0.79, 1.94E-07],
                    [0.8, 1.89E-07], [0.81, 1.91E-07], [0.82, 1.97E-07], [0.83, 2.01E-07], [0.84, 1.98E-07],
                    [0.85, 1.91E-07], [0.86, 1.88E-07], [0.87, 1.91E-07], [0.88, 2.19E-07], [0.89, 2.89E-07],
                    [0.9, 3.86E-07], [0.91, 5.64E-07], [0.92, 8.43E-07], [0.93, 1.05E-06], [0.94, 9.30E-07],
                    [0.95, 5.35E-07], [0.96, 2.72E-07], [0.97, 2.16E-07], [0.98, 2.05E-07], [0.99, 2.35E-07],
                    [1, 3.00E-07], [1.01, 3.98E-07], [1.02, 4.99E-07], [1.03, 6.01E-07], [1.04, 6.68E-07],
                    [1.05, 6.33E-07], [1.06, 5.33E-07], [1.07, 4.40E-07], [1.08, 3.69E-07], [1.09, 3.26E-07],
                    [1.1, 3.11E-07], [1.11, 3.41E-07], [1.12, 4.28E-07], [1.13, 6.35E-07], [1.14, 1.08E-06],
                    [1.15, 1.99E-06], [1.16, 3.31E-06], [1.17, 4.83E-06], [1.18, 6.59E-06], [1.19, 9.23E-06],
                    [1.2, 1.30E-05], [1.21, 1.59E-05], [1.22, 1.34E-05], [1.23, 8.47E-06], [1.24, 5.03E-06],
                    [1.25, 3.26E-06], [1.26, 2.32E-06], [1.27, 1.82E-06], [1.28, 1.53E-06], [1.29, 1.35E-06],
                    [1.3, 1.21E-06], [1.31, 1.08E-06], [1.32, 1.00E-06], [1.33, 1.04E-06], [1.34, 1.26E-06],
                    [1.35, 1.79E-06], [1.36, 2.66E-06], [1.37, 4.44E-06], [1.38, 7.21E-06], [1.39, 1.04E-05],
                    [1.4, 1.16E-05], [1.41, 1.20E-05], [1.42, 1.23E-05], [1.43, 1.15E-05], [1.44, 1.02E-05],
                    [1.45, 8.63E-06], [1.46, 7.16E-06], [1.47, 5.80E-06], [1.48, 4.66E-06], [1.49, 3.89E-06],
                    [1.5, 3.40E-06], [1.51, 3.19E-06], [1.52, 3.18E-06], [1.53, 3.29E-06], [1.54, 3.24E-06],
                    [1.55, 2.86E-06], [1.56, 2.47E-06], [1.57, 2.25E-06], [1.58, 2.15E-06], [1.59, 2.18E-06],
                    [1.6, 2.30E-06], [1.61, 2.56E-06], [1.62, 3.01E-06], [1.63, 3.78E-06], [1.64, 4.94E-06],
                    [1.65, 6.79E-06], [1.66, 9.65E-06], [1.67, 1.39E-05], [1.68, 1.89E-05], [1.69, 2.50E-05],
                    [1.7, 3.46E-05], [1.71, 5.29E-05], [1.72, 8.61E-05], [1.73, 9.80E-05], [1.74, 8.69E-05],
                    [1.75, 8.12E-05], [1.76, 8.20E-05], [1.77, 7.23E-05], [1.78, 6.15E-05], [1.79, 5.72E-05],
                    [1.8, 5.64E-05], [1.81, 5.58E-05], [1.82, 5.32E-05], [1.83, 5.00E-05], [1.84, 4.56E-05],
                    [1.85, 4.13E-05], [1.86, 3.78E-05], [1.87, 3.50E-05], [1.88, 3.37E-05], [1.89, 3.41E-05],
                    [1.9, 3.46E-05], [1.91, 3.46E-05], [1.92, 3.47E-05], [1.93, 3.55E-05], [1.94, 3.62E-05],
                    [1.95, 3.55E-05], [1.96, 3.45E-05], [1.97, 3.39E-05], [1.98, 3.39E-05], [1.99, 3.47E-05],
                    [2, 3.61E-05], [2.01, 3.66E-05], [2.02, 3.57E-05], [2.03, 3.46E-05], [2.04, 3.45E-05],
                    [2.05, 3.46E-05], [2.06, 3.43E-05], [2.07, 3.38E-05], [2.08, 3.38E-05], [2.09, 3.53E-05],
                    [2.1, 3.74E-05], [2.11, 3.90E-05], [2.12, 4.15E-05], [2.13, 4.72E-05], [2.14, 5.10E-05],
                    [2.15, 4.54E-05], [2.16, 4.10E-05], [2.17, 4.01E-05], [2.18, 4.02E-05], [2.19, 4.13E-05],
                    [2.2, 4.40E-05], [2.21, 4.99E-05], [2.22, 5.81E-05], [2.23, 7.19E-05], [2.24, 9.01E-05],
                    [2.25, 1.57E-04], [2.26, 2.11E-04], [2.27, 2.70E-04], [2.28, 3.59E-04], [2.29, 5.18E-04],
                    [2.3, 7.34E-04], [2.31, 8.12E-04], [2.32, 6.54E-04], [2.33, 5.95E-04], [2.34, 6.69E-04],
                    [2.35, 7.58E-04], [2.36, 7.35E-04], [2.37, 7.06E-04], [2.38, 7.47E-04], [2.39, 7.56E-04],
                    [2.4, 7.50E-04], [2.41, 7.14E-04], [2.42, 6.84E-04], [2.43, 6.63E-04], [2.44, 6.21E-04],
                    [2.45, 5.78E-04], [2.46, 5.33E-04], [2.47, 5.03E-04], [2.48, 4.65E-04], [2.49, 4.45E-04],
                    [2.5, 4.19E-04]]


    wavelength_real_n = np.array(wavelength_real_n)
    wavelength_k = np.array(wavelength_k)
    # wavelength_k[:,1] = wavelength_k[:,1]*2
    wavelength_k[:15,1] = wavelength_k[:15,1]*uv_abs_factor
    real_n = np.interp(wavelength, 1e3*wavelength_real_n[:, 0], wavelength_real_n[:, 1], left=1.557,right=1.483)
    imag_n = np.interp(wavelength, 1e3*wavelength_k[:, 0], wavelength_k[:, 1],left=9.86E-06,right=4.19E-04)

    n = real_n + 1j*imag_n

    return n

def refractive_index_SiN(wavelength):
    """
    https://refractiveindex.info/?shelf=main&book=Si3N4&page=Vogt-2.09

    :param wavelength:
    :return:
    """
    wavelength_real_n = [[0.25,2.459],[0.26,2.426],[0.27,2.396],[0.28,2.369],[0.29,2.345],[0.3,2.323],[0.31,2.303],[0.32,2.285],[0.33,2.269],[0.34,2.254],[0.35,2.241],[0.36,2.228],[0.37,2.217],[0.38,2.206],[0.39,2.196],[0.4,2.187],[0.41,2.179],[0.42,2.171],[0.43,2.163],[0.44,2.156],[0.45,2.15],[0.46,2.144],[0.47,2.138],[0.48,2.133],[0.49,2.128],[0.5,2.124],[0.51,2.119],[0.52,2.115],[0.53,2.112],[0.54,2.109],[0.55,2.106],[0.56,2.103],[0.57,2.101],[0.58,2.099],[0.59,2.096],[0.6,2.094],[0.61,2.092],[0.62,2.091],[0.63,2.089],[0.64,2.087],[0.65,2.086],[0.66,2.084],[0.67,2.083],[0.68,2.082],[0.69,2.081],[0.7,2.079],[0.71,2.078],[0.72,2.077],[0.73,2.076],[0.74,2.075],[0.75,2.074],[0.76,2.074],[0.77,2.073],[0.78,2.072],[0.79,2.071],[0.8,2.07],[0.81,2.07],[0.82,2.069],[0.83,2.068],[0.84,2.068],[0.85,2.067],[0.86,2.067],[0.87,2.066],[0.88,2.066],[0.89,2.065],[0.9,2.065],[0.91,2.064],[0.92,2.064],[0.93,2.063],[0.94,2.063],[0.95,2.062],[0.96,2.062],[0.97,2.062],[0.98,2.061],[0.99,2.061],[1,2.06],[1.01,2.06],[1.02,2.06],[1.03,2.059],[1.04,2.059],[1.05,2.059],[1.06,2.059],[1.07,2.058],[1.08,2.058],[1.09,2.058],[1.1,2.057],[1.11,2.057],[1.12,2.057],[1.13,2.057],[1.14,2.056],[1.15,2.056],[1.16,2.056],[1.17,2.056],[1.18,2.056],[1.19,2.055],[1.2,2.055],[1.21,2.055],[1.22,2.055],[1.23,2.055],[1.24,2.054],[1.25,2.054],[1.26,2.054],[1.27,2.054],[1.28,2.054],[1.29,2.054],[1.3,2.053],[1.31,2.053],[1.32,2.053],[1.33,2.053],[1.34,2.053],[1.35,2.053],[1.36,2.053],[1.37,2.052],[1.38,2.052],[1.39,2.052],[1.4,2.052],[1.41,2.052],[1.42,2.052],[1.43,2.052],[1.44,2.052],[1.45,2.052],[1.46,2.051],[1.47,2.051],[1.48,2.051],[1.49,2.051],[1.5,2.051],[1.51,2.051],[1.52,2.051],[1.53,2.051],[1.54,2.051],[1.55,2.051],[1.56,2.05],[1.57,2.05],[1.58,2.05],[1.59,2.05],[1.6,2.05],[1.61,2.05],[1.62,2.05],[1.63,2.05],[1.64,2.05],[1.65,2.05],[1.66,2.05],[1.67,2.05],[1.68,2.05],[1.69,2.049],[1.7,2.049]]
    wavelength_k = [[0.25,2.47E-01],[0.26,2.03E-01],[0.27,1.69E-01],[0.28,1.41E-01],[0.29,1.19E-01],[0.3,1.00E-01],[0.31,8.46E-02],[0.32,7.16E-02],[0.33,6.06E-02],[0.34,5.12E-02],[0.35,4.32E-02],[0.36,3.63E-02],[0.37,3.03E-02],[0.38,2.52E-02],[0.39,2.08E-02],[0.4,1.70E-02],[0.41,1.37E-02],[0.42,1.09E-02],[0.43,8.51E-03],[0.44,6.50E-03],[0.45,4.81E-03],[0.46,3.42E-03],[0.47,2.31E-03],[0.48,1.43E-03],[0.49,7.86E-04],[0.5,3.41E-04],[0.51,8.47E-05],[0.52,3.96E-07],[0.53,0.00E+00],[0.54,0.00E+00],[0.55,0.00E+00],[0.56,0.00E+00],[0.57,0.00E+00],[0.58,0.00E+00],[0.59,0.00E+00],[0.6,0.00E+00],[0.61,0.00E+00],[0.62,0.00E+00],[0.63,0.00E+00],[0.64,0.00E+00],[0.65,0.00E+00],[0.66,0.00E+00],[0.67,0.00E+00],[0.68,0.00E+00],[0.69,0.00E+00],[0.7,0.00E+00],[0.71,0.00E+00],[0.72,0.00E+00],[0.73,0.00E+00],[0.74,0.00E+00],[0.75,0.00E+00],[0.76,0.00E+00],[0.77,0.00E+00],[0.78,0.00E+00],[0.79,0.00E+00],[0.8,0.00E+00],[0.81,0.00E+00],[0.82,0.00E+00],[0.83,0.00E+00],[0.84,0.00E+00],[0.85,0.00E+00],[0.86,0.00E+00],[0.87,0.00E+00],[0.88,0.00E+00],[0.89,0.00E+00],[0.9,0.00E+00],[0.91,0.00E+00],[0.92,0.00E+00],[0.93,0.00E+00],[0.94,0.00E+00],[0.95,0.00E+00],[0.96,0.00E+00],[0.97,0.00E+00],[0.98,0.00E+00],[0.99,0.00E+00],[1,0.00E+00],[1.01,0.00E+00],[1.02,0.00E+00],[1.03,0.00E+00],[1.04,0.00E+00],[1.05,0.00E+00],[1.06,0.00E+00],[1.07,0.00E+00],[1.08,0.00E+00],[1.09,0.00E+00],[1.1,0.00E+00],[1.11,0.00E+00],[1.12,0.00E+00],[1.13,0.00E+00],[1.14,0.00E+00],[1.15,0.00E+00],[1.16,0.00E+00],[1.17,0.00E+00],[1.18,0.00E+00],[1.19,0.00E+00],[1.2,0.00E+00],[1.21,0.00E+00],[1.22,0.00E+00],[1.23,0.00E+00],[1.24,0.00E+00],[1.25,0.00E+00],[1.26,0.00E+00],[1.27,0.00E+00],[1.28,0.00E+00],[1.29,0.00E+00],[1.3,0.00E+00],[1.31,0.00E+00],[1.32,0.00E+00],[1.33,0.00E+00],[1.34,0.00E+00],[1.35,0.00E+00],[1.36,0.00E+00],[1.37,0.00E+00],[1.38,0.00E+00],[1.39,0.00E+00],[1.4,0.00E+00],[1.41,0.00E+00],[1.42,0.00E+00],[1.43,0.00E+00],[1.44,0.00E+00],[1.45,0.00E+00],[1.46,0.00E+00],[1.47,0.00E+00],[1.48,0.00E+00],[1.49,0.00E+00],[1.5,0.00E+00],[1.51,0.00E+00],[1.52,0.00E+00],[1.53,0.00E+00],[1.54,0.00E+00],[1.55,0.00E+00],[1.56,0.00E+00],[1.57,0.00E+00],[1.58,0.00E+00],[1.59,0.00E+00],[1.6,0.00E+00],[1.61,0.00E+00],[1.62,0.00E+00],[1.63,0.00E+00],[1.64,0.00E+00],[1.65,0.00E+00],[1.66,0.00E+00],[1.67,0.00E+00],[1.68,0.00E+00],[1.69,0.00E+00],[1.7,0.00E+00]]

    wavelength_real_n = np.array(wavelength_real_n)
    wavelength_k = np.array(wavelength_k)
    real_n = np.interp(wavelength, 1e3 * wavelength_real_n[:, 0], wavelength_real_n[:, 1], left=1.557, right=1.483)
    imag_n = np.interp(wavelength, 1e3 * wavelength_k[:, 0], wavelength_k[:, 1], left=9.86E-06, right=4.19E-04)

    n = real_n + 1j * imag_n

    return n


if __name__ == '__main__':
    wavelength = np.linspace(300, 1000, 100)
    n = refractive_index_silicon(wavelength)
    print(n)